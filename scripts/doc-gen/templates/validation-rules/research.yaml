# Research Document Validation Rules
# 
# Purpose: Define validation rules for research documents
# Used by: dt-doc-validate CLI tool
# Reference: VALIDATION.md (Type-Specific Rules section)
#
# Document types covered:
#   - research-topic.md (individual research topic)
#   - research-summary.md (aggregated findings)
#   - requirements.md (captured requirements)
#   - README.md (research hub)

---

# Research Topic Document
research_topic:
  description: "Individual research topic validation rules"
  path_pattern: "admin/research/*/research-*.md"
  exclude_pattern: "research-summary.md"
  
  common_rules:
    - rule_id: COMMON_STATUS_HEADER
      enabled: true
    - rule_id: COMMON_CREATED_DATE
      enabled: true
    - rule_id: COMMON_LAST_UPDATED
      enabled: true
    - rule_id: COMMON_STALE_DATE
      enabled: true
      threshold_days: 30
  
  required_sections:
    - section_id: research_question
      pattern: "^## ğŸ¯ Research Question"
      error_code: MISSING_SECTION
      error_message: "Missing 'Research Question' section"
      fix_suggestion: "Add '## ğŸ¯ Research Question' section after metadata block"
      
    - section_id: findings
      pattern: "^## ğŸ“Š Findings"
      error_code: MISSING_SECTION
      error_message: "Missing 'Findings' section"
      fix_suggestion: "Add '## ğŸ“Š Findings' section after methodology"
      
    - section_id: recommendations
      pattern: "^## ğŸ’¡ Recommendations"
      error_code: MISSING_SECTION
      error_message: "Missing 'Recommendations' section"
      fix_suggestion: "Add '## ğŸ’¡ Recommendations' section after Findings"
  
  optional_sections:
    - pattern: "^## ğŸ“‹ Requirements Discovered"
      description: "Requirements identified during research"
    - pattern: "^## ğŸš€ Next Steps"
      description: "Recommended follow-up actions"
    - pattern: "^## ğŸ”— References"
      description: "Sources and related documents"
  
  examples:
    valid: |
      # Research: Authentication Methods
      
      **Status:** âœ… Complete
      **Created:** 2026-01-16
      **Last Updated:** 2026-01-16
      
      ---
      
      ## ğŸ¯ Research Question
      
      What authentication method best fits our security requirements?
      
      ---
      
      ## ğŸ“Š Findings
      
      - Finding 1
      - Finding 2
      
      ---
      
      ## ğŸ’¡ Recommendations
      
      Recommend OAuth 2.0 with JWT tokens.

---

# Research Summary Document
research_summary:
  description: "Aggregated research findings validation rules"
  path_pattern: "admin/research/*/research-summary.md"
  
  common_rules:
    - rule_id: COMMON_STATUS_HEADER
      enabled: true
    - rule_id: COMMON_CREATED_DATE
      enabled: true
    - rule_id: COMMON_LAST_UPDATED
      enabled: true
    - rule_id: COMMON_STALE_DATE
      enabled: true
      threshold_days: 30
  
  required_sections:
    - section_id: research_overview
      pattern: "^## ğŸ“‹ Research Overview"
      error_code: MISSING_SECTION
      error_message: "Missing 'Research Overview' section"
      fix_suggestion: "Add '## ğŸ“‹ Research Overview' section after metadata"
      
    - section_id: key_insights
      pattern: "^## ğŸ’¡ Key Insights"
      error_code: MISSING_SECTION
      error_message: "Missing 'Key Insights' section"
      fix_suggestion: "Add '## ğŸ’¡ Key Insights' section to summarize findings"
      
    - section_id: recommendations
      pattern: "^## ğŸ¯ Recommendations"
      error_code: MISSING_SECTION
      error_message: "Missing 'Recommendations' section"
      fix_suggestion: "Add '## ğŸ¯ Recommendations' section after Key Insights"
  
  optional_sections:
    - pattern: "^## ğŸ“‹ Requirements Summary"
      description: "Summary of discovered requirements"
    - pattern: "^## ğŸš€ Next Steps"
      description: "Recommended follow-up actions"

---

# Requirements Document
requirements:
  description: "Requirements document validation rules"
  path_pattern: "admin/research/*/requirements.md"
  
  common_rules:
    - rule_id: COMMON_STATUS_HEADER
      enabled: true
    - rule_id: COMMON_CREATED_DATE
      enabled: true
    - rule_id: COMMON_LAST_UPDATED
      enabled: true
    - rule_id: COMMON_STALE_DATE
      enabled: true
      threshold_days: 60  # Requirements may be stable longer
  
  required_sections:
    - section_id: overview
      pattern: "^## ğŸ“‹ Overview"
      error_code: MISSING_SECTION
      error_message: "Missing 'Overview' section"
      fix_suggestion: "Add '## ğŸ“‹ Overview' section after metadata"
      
    - section_id: nfr
      pattern: "^## ğŸ¯ Non-Functional Requirements"
      error_code: MISSING_SECTION
      error_message: "Missing 'Non-Functional Requirements' section"
      fix_suggestion: "Add '## ğŸ¯ Non-Functional Requirements' section"
  
  # Functional requirements use inline format (### FR-NN:), not section headers
  content_patterns:
    - pattern_id: functional_requirements
      pattern: "### FR-\\d{2}:"
      severity: WARNING
      error_message: "No functional requirements found"
      fix_suggestion: "Add functional requirements using format '### FR-01: [Name]'"
  
  optional_sections:
    - pattern: "^## âš ï¸ Constraints"
      description: "Project constraints"
    - pattern: "^## ğŸ“ Assumptions"
      description: "Project assumptions"
    - pattern: "^## ğŸš€ Next Steps"
      description: "Recommended follow-up actions"

---

# Research Hub (README.md)
research_hub:
  description: "Research hub (README.md) validation rules"
  path_pattern: "admin/research/*/README.md"
  
  common_rules:
    - rule_id: COMMON_STATUS_HEADER
      enabled: true
    - rule_id: COMMON_CREATED_DATE
      enabled: true
    - rule_id: COMMON_LAST_UPDATED
      enabled: true
    - rule_id: COMMON_STALE_DATE
      enabled: true
      threshold_days: 30
  
  required_sections:
    - section_id: quick_links
      pattern: "^## ğŸ“‹ Quick Links"
      error_code: MISSING_SECTION
      error_message: "Missing 'Quick Links' section"
      fix_suggestion: "Add '## ğŸ“‹ Quick Links' section after metadata"
      
    - section_id: research_overview
      pattern: "^## ğŸ¯ Research Overview"
      error_code: MISSING_SECTION
      error_message: "Missing 'Research Overview' section"
      fix_suggestion: "Add '## ğŸ¯ Research Overview' section after Quick Links"
  
  optional_sections:
    - pattern: "^## ğŸ“Š Research Status"
      description: "Status table of research topics"
    - pattern: "^## ğŸš€ Next Steps"
      description: "Recommended next actions"
